# פתרון בעיות - Invoice4U Integration

## 🔴 שגיאה: "Invalid Invoice4U credentials"

### סיבות אפשריות:

#### 1. **פרטי התחברות שגויים**
- ✅ ודא שהאימייל והסיסמה נכונים
- ✅ נסה להתחבר ישירות לאתר Invoice4U עם אותם פרטים
- ✅ שים לב לרווחים מיותרים בתחילת או בסוף השדות

#### 2. **הסביבה שגויה**
- ✅ אם אתה משתמש בחשבון **Production**, ודא שה-checkbox מסומן
- ✅ אם זה חשבון **Staging/QA**, הסר את הסימון

#### 3. **חשבון לא פעיל**
- ✅ ודא שהחשבון ב-Invoice4U פעיל ותקף
- ✅ בדוק שאין חובות או השהיה על החשבון

### 🔍 איך לבדוק מה השגיאה המדויקת:

1. פתח את **Developer Tools** בדפדפן (F12)
2. עבור ללשונית **Console**
3. נסה להתחבר שוב
4. חפש הודעות שגיאה אדומות
5. העתק את השגיאה ובדוק אותה

### ✅ פתרונות מומלצים:

#### פתרון 1: אפס את הסיסמה ב-Invoice4U
```
1. היכנס לאתר Invoice4U
2. עבור להגדרות החשבון
3. שנה את הסיסמה לסיסמה חדשה
4. השתמש בסיסמה החדשה במערכת CRM
```

#### פתרון 2: בדוק שאתה מתחבר לסביבה הנכונה
```
Production: https://api.invoice4u.co.il
Staging: https://apiqa.invoice4u.co.il
```

#### פתרון 3: בדוק את הלוגים בשרת
```bash
# בטרמינל, הרץ את הפרויקט עם לוגים
npm run dev

# שים לב להודעות מסוג:
# "Testing Invoice4U credentials..."
# "Invoice4U login error:"
```

### 📝 דוגמה לפרטים תקינים:

```
אימייל: your.email@example.com
סיסמה: YourPassword123!
✅ Production מסומן (אם זה חשבון ייצור)
```

---

## 🔴 שגיאות נוספות

### "Failed to create customer"

**סיבה:** הלקוח כבר קיים במערכת או חסרים פרטים נדרשים.

**פתרון:**
- המערכת תנסה למצוא את הלקוח אוטומטית
- ודא שיש שם ללקוח במערכת CRM
- אם השגיאה חוזרת, נסה ליצור את הלקוח ידנית ב-Invoice4U תחילה

### "Failed to create document"

**סיבה:** חסרים פרטים במסמך או שגיאה בפורמט.

**פתרון:**
1. ודא שכל הפריטים במסמך מלאים:
   - שם הפריט
   - כמות (מספר חיובי)
   - מחיר (מספר חיובי)
2. בדוק שיש לפחות פריט אחד במסמך
3. ודא שהלקוח קיים במערכת

### "SOAP Error" או "Connection timeout"

**סיבה:** בעיית תקשורת עם שרתי Invoice4U.

**פתרון:**
1. בדוק את החיבור לאינטרנט
2. נסה שוב מאוחר יותר (ייתכן שהשרת בתחזוקה)
3. בדוק ש-firewall לא חוסם את החיבור

---

## 🧪 בדיקה ידנית של החיבור

אם אתה מפתח, תוכל לבדוק את החיבור ישירות:

### בדיקה דרך Node.js:

```javascript
const soap = require('soap');

const wsdl = 'https://api.invoice4u.co.il/Services/ApiService.svc?singleWsdl';

soap.createClient(wsdl, async (err, client) => {
  if (err) {
    console.error('SOAP Error:', err);
    return;
  }

  const result = await client.VerifyLoginAsync({
    email: 'YOUR_EMAIL',
    password: 'YOUR_PASSWORD',
  });

  console.log('Result:', result);
});
```

---

## 📞 תמיכה

אם אף אחד מהפתרונות לא עזר:

1. **תמיכת Invoice4U:**
   - אתר: https://www.invoice4u.co.il
   - דוקומנטציה: https://invoice4uapi.docs.apiary.io

2. **בדוק את הלוגים:**
   ```bash
   # הרץ את הפרויקט עם לוגים
   npm run dev
   
   # או בדוק את לוגי הייצור
   pm2 logs
   ```

3. **צור issue ב-GitHub** עם:
   - תיאור הבעיה
   - צילום מסך של השגיאה
   - הלוגים מהקונסול

---

## ✅ Checklist לפני פנייה לתמיכה

- [ ] ניסיתי להתחבר ישירות לאתר Invoice4U עם אותם פרטים
- [ ] בדקתי שהאימייל והסיסמה נכונים (ללא רווחים)
- [ ] בדקתי שבחרתי את הסביבה הנכונה (Production/Staging)
- [ ] בדקתי את הלוגים בדפדפן (F12 → Console)
- [ ] בדקתי את הלוגים בשרת (`npm run dev`)
- [ ] הסיסמה עובדת באתר Invoice4U אבל לא במערכת CRM
- [ ] החשבון שלי ב-Invoice4U פעיל ותקף

---

**עדכון אחרון:** נובמבר 2025

